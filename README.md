## 今回ご提案するのはRubyとSeleniumを使った、ブラウザ操作を伴うスクレイピングプログラムです!

毎日、決まった時間になると、いつものwebサイトに行って、いつもの操作をして、いつものデータを確認してるなんてことはありませんか？  
熟練するとブラウザの画面が変わるより速くマウスカーソルを次のクリック位置へ待機させ、ブラウザの反応が遅いと舌打ちなんかしたりして。そんな作業からあなたを開放するプログラムです。

## 具体的になにができるの？

プログラムが起動すると、事前にcsvファイルで設定したURLへ訪問します。
そして、webブラウザを操作し（もちろんログインが必要ならログインします）、その時点での最新情報を取得して記録、関係者へメール配信し作業ログも残します。

## 必要なものは？

 このプログラムを動かすために必要なものを下記に示します。
 (バージョンについては必ず合っていなくても、ある程度近ければ大丈夫だとは思います。)

 * ruby 2.6.6
 * selenium-webdriver (3.142.7)

## インストール方法

Rubyのインストール方法については、沢山の素晴らしい記事がありますので、`ruby インストール`などで検索して、そちらを参考になさって下さい。
seleniumのインストールについては、過去の苦い経験をもとに、Qiitaへ記事を投稿しましたので、下記リンクの記事にてインストールをお願いします。

[[Ruby]ハマりを最小限に抑えるseleniumの導入方法](https://qiita.com/atsushi0919/items/5502e7cdbdb878947cc9)

## 使い方

事前に`visiting_.csv`というファイルへ訪問先の情報を登録します。（初期状態ではサンプルで id: 2件目まで入っていますが、1行目（タイトル）だけ残して削除して頂いて構いません。）
- id: 基本的に通し番号です。深い意味はないですが重複禁止です。
- name: お好きなお名前で大丈夫です。「○○社 発注情報」 など
- url: 最初にアクセスする場所です。
- userid: 対象URLへ訪問する際の固有のお名前です。webサイトによっては「ID」とか「メルアド」などの場合があります。
- password: 本当に・本当に慎重に、間違ってはいけません。あと何回間違ったらロックとかのメッセージはない場合もあります。私は一瞬で5連続突撃してアカウントロックされ、その企業のサービスセンターにメールしたことがあります。

一通りの設定が済んだら、下記を実行しましょう。
`ruby main.rb`

## 注意点

webスクレイピングは権利を保証されいてる一方、悪用すると大変なことにもなります。下記の記事を心に刻みましょう。

[- Webスクレイピングの注意事項一覧](https://qiita.com/nezuq/items/c5e827e1827e7cb29011)
[- WEBスクレイピングの技術と懸念事項](https://qiita.com/tetsukick/items/6b4322199d4702047ced)

## ライセンスについて

ライセンスを気にする様なレベルが高いことをしているわけので、特に言うことはありません。
でも、もし誰かの役に立ったのであれば嬉しいので「イイネ」的なものとか批評を頂ければ嬉しいです。

- ツイッター： https://mobile.twitter.com/atsushi_0919_
- FB：　https://m.facebook.com/atsushi.hatakeyama?ref=bookmarks
- Qiita： https://qiita.com/atsushi0919
